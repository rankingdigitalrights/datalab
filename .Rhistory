library(googlesheets)
token <- googlesheets::gs_auth()
gs_gs("https://docs.google.com/spreadsheets/d/1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y/edit")
gs_gs("https://docs.google.com/spreadsheets/d/1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y/")
spreadhsheetID <- gs_gs("https://docs.google.com/spreadsheets/d/1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y/")
spreadhsheetID <- gs_gs("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
spreadhsheetID <- gs_key("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
View(spreadsheetObj)
devtools::install_github("tidyverse/googlesheets4")
# library(googlesheets)
# devtools::install_github("tidyverse/googlesheets4")
library(googlesheets4)
# spreadsheetID <- gs_key("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
spreadsheetID <- googlesheets4::sheets_has_token()
googlesheets4::sheets_has_token()
# spreadsheetID <- gs_key("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
token <- googlesheets4::sheets_auth()
save(token, "googleAuthToken.RData")
save(token, file = "googleAuthToken.RData")
# spreadsheetID <- gs_key("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
# token <- googlesheets4::sheets_auth()
# save(token, file = "googleAuthToken.RData")
googlesheets4::sheets_has_token()
spreadsheetID <- gs_key("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
googlesheets4::read_sheet("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
googlesheets4::sheets_endpoints("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
googlesheets4::sheets_get("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
ss_meta <- googlesheets4::sheets_get("1EBq-jrwx_P_908aMaVaOup08p0Ii2UsJ-upPRM3EK5Y")
ss_obj <- googlesheets4::read_sheet(ss_meta)
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id)
ss_obj
View(ss_meta)
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = str_detect(., "Comments")) # or read directly by ID / name
library(tidyverse)
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = str_detect(., "Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = str_detect( "Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = ".*Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = "\.*Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = "\\.*Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = "\\.\\*Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = "Comments")) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, range = "Comments") # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, ws = "G1", range = "Comments") # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, sheet = "G1", range = "Comments") # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, sheet = "G1") # or read directly by ID / name
ss_obj
View(ss_obj)
ss_meta$named_ranges %>% class()
ss_meta$named_ranges %>% colnames()
ss_meta$named_ranges %>% head(10)
ss_meta$named_ranges %>%  %>% arrange(sheet_name) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_name) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_name, range) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_name, id) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_id, id) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_id, start_row) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_id, start_column, start_row) %>% head(10)
ss_meta$named_ranges %>% arrange(sheet_name, start_column, start_row) %>% head(10)
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
ss_id <- "1o_JbAOKooSXfwvecPuJha-LIE9ltOAa8kl3k7nTy1Fk"
ss_meta <- googlesheets4::sheets_get(ss_id)
ss_meta %>%
select(named_ranges) %>%
filter(str_detect(Comments))
ss_meta[["named_ranges"]] %>%
filter(str_detect(Comments))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "Comments"))
library(googledrive)
googledrive::drive_auth()
library(googledrive)
filesystem <- googledrive::drive_ls()
filesystem
filesystem$drive_resource[1]
here::here()
lubridate::today()
save(filesystem, file = str_c("drive_fs", lubridate::today()))
# spreadsheetObj <- gs_read_cellfeed(spreadhsheetID)
ss_id <- "1o_JbAOKooSXfwvecPuJha-LIE9ltOAa8kl3k7nTy1Fk"
ss_meta <- googlesheets4::sheets_get(ss_id)
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, sheet = "F3") # or read directly by ID / name
head(ss_obj)
ss_obj$`Verizon Media`
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, sheet = "F3", col_types = c) # or read directly by ID / name
ss_obj <- googlesheets4::read_sheet(ss_meta$spreadsheet_id, sheet = "F3", col_types = c("c")) # or read directly by ID / name
head(ss_obj)
ss_obj
ss_obj %>% View()
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03[A-Z]"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03[A-Z]?"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03[A-Z]*"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03[A-Z]{0,1}"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03[A-Z]"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03G"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03G")) %>%
mutate(predicate = str_extract(name, "Comments"))
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03G")) %>%
mutate(predicate = str_extract(name, "Comments")) %>%
select(predicate, everything())
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03G")) %>%
mutate(predicate = str_extract(name, "\d+")) %>%
ss_meta[["named_ranges"]] %>%
filter(str_detect(name, "S03G")) %>%
mutate(predicate = str_extract(name, "\\d+")) %>%
select(predicate, everything())
